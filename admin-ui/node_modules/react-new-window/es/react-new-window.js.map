{"version":3,"file":"react-new-window.js","sources":["../node_modules/object-assign/index.js","../node_modules/prop-types/lib/ReactPropTypesSecret.js","../node_modules/prop-types/factoryWithThrowingShims.js","../node_modules/prop-types/index.js","../src/NewWindow.js"],"sourcesContent":["/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Component dependencies.\n * @private\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport PropTypes from 'prop-types'\n\n/**\n * The NewWindow class object.\n * @public\n */\n\nclass NewWindow extends React.PureComponent {\n  /**\n   * NewWindow default props.\n   */\n  static defaultProps = {\n    url: '',\n    name: '',\n    title: '',\n    features: { width: '600px', height: '640px' },\n    onBlock: null,\n    onUnload: null,\n    center: 'parent',\n    copyStyles: true\n  }\n\n  /**\n   * The NewWindow function constructor.\n   * @param {Object} props\n   */\n  constructor(props) {\n    super(props)\n    this.container = document.createElement('div')\n    this.window = null\n    this.windowCheckerInterval = null\n    this.released = false\n    this.state = {\n      mounted: false\n    }\n  }\n\n  /**\n   * Render the NewWindow component.\n   */\n  render() {\n    if (!this.state.mounted) return null\n    return ReactDOM.createPortal(this.props.children, this.container)\n  }\n\n  componentDidMount() {\n    this.openChild()\n    this.setState({ mounted: true })\n  }\n\n  /**\n   * Create the new window when NewWindow component mount.\n   */\n  openChild() {\n    const { url, title, name, features, onBlock, center } = this.props\n\n    // Prepare position of the new window to be centered against the 'parent' window or 'screen'.\n    if (\n      typeof center === 'string' &&\n      (features.width === undefined || features.height === undefined)\n    ) {\n      console.warn(\n        'width and height window features must be present when a center prop is provided'\n      )\n    } else if (center === 'parent') {\n      features.left =\n        window.top.outerWidth / 2 + window.top.screenX - features.width / 2\n      features.top =\n        window.top.outerHeight / 2 + window.top.screenY - features.height / 2\n    } else if (center === 'screen') {\n      const screenLeft =\n        window.screenLeft !== undefined ? window.screenLeft : screen.left\n      const screenTop =\n        window.screenTop !== undefined ? window.screenTop : screen.top\n\n      const width = window.innerWidth\n        ? window.innerWidth\n        : document.documentElement.clientWidth\n          ? document.documentElement.clientWidth\n          : screen.width\n      const height = window.innerHeight\n        ? window.innerHeight\n        : document.documentElement.clientHeight\n          ? document.documentElement.clientHeight\n          : screen.height\n\n      features.left = width / 2 - features.width / 2 + screenLeft\n      features.top = height / 2 - features.height / 2 + screenTop\n    }\n\n    // Open a new window.\n    this.window = window.open(url, name, toWindowFeatures(features))\n\n    // When a new window use content from a cross-origin there's no way we can attach event\n    // to it. Therefore, we need to detect in a interval when the new window was destroyed\n    // or was closed.\n    this.windowCheckerInterval = setInterval(() => {\n      if (!this.window || this.window.closed) {\n        this.release()\n      }\n    }, 50)\n\n    // Check if the new window was succesfully opened.\n    if (this.window) {\n      this.window.document.title = title\n      this.window.document.body.appendChild(this.container)\n\n      // If specified, copy styles from parent window's document.\n      if (this.props.copyStyles) {\n        setTimeout(() => copyStyles(document, this.window.document), 0)\n      }\n\n      // Release anything bound to this component before the new window unload.\n      this.window.addEventListener('beforeunload', () => this.release())\n    } else {\n      // Handle error on opening of new window.\n      if (typeof onBlock === 'function') {\n        onBlock.call(null)\n      } else {\n        console.warn('A new window could not be opened. Maybe it was blocked.')\n      }\n    }\n  }\n\n  /**\n   * Close the opened window (if any) when NewWindow will unmount.\n   */\n  componentWillUnmount() {\n    if (this.window) {\n      this.window.close()\n    }\n  }\n\n  /**\n   * Release the new window and anything that was bound to it.\n   */\n  release() {\n    // This method can be called once.\n    if (this.released) {\n      return\n    }\n    this.released = true\n\n    // Remove checker interval.\n    clearInterval(this.windowCheckerInterval)\n\n    // Call any function bound to the `onUnload` prop.\n    const { onUnload } = this.props\n\n    if (typeof onUnload === 'function') {\n      onUnload.call(null)\n    }\n  }\n}\n\nNewWindow.propTypes = {\n  children: PropTypes.node,\n  url: PropTypes.string,\n  name: PropTypes.string,\n  title: PropTypes.string,\n  features: PropTypes.object,\n  onUnload: PropTypes.func,\n  onBlock: PropTypes.func,\n  center: PropTypes.oneOf(['parent', 'screen']),\n  copyStyles: PropTypes.bool\n}\n\n/**\n * Utility functions.\n * @private\n */\n\n/**\n * Copy styles from a source document to a target.\n * @param {Object} source\n * @param {Object} target\n * @private\n */\n\nfunction copyStyles(source, target) {\n  Array.from(source.styleSheets).forEach(styleSheet => {\n    // For <style> elements\n    let rules\n    try {\n      rules = styleSheet.cssRules\n    } catch (err) {\n      console.error(err)\n    }\n    if (rules) {\n      const newStyleEl = source.createElement('style')\n\n      // Write the text of each rule into the body of the style element\n      Array.from(styleSheet.cssRules).forEach(cssRule => {\n        const { cssText, type } = cssRule\n        let returnText = cssText\n        // Check if the cssRule type is CSSImportRule (3) or CSSFontFaceRule (5) to handle local imports on a about:blank page\n        // '/custom.css' turns to 'http://my-site.com/custom.css'\n        if ([3, 5].includes(type)) {\n          returnText = cssText\n            .split('url(')\n            .map(line => {\n              if (line[1] === '/') {\n                return `${line.slice(0, 1)}${\n                  window.location.origin\n                }${line.slice(1)}`\n              }\n              return line\n            })\n            .join('url(')\n        }\n        newStyleEl.appendChild(source.createTextNode(returnText))\n      })\n\n      target.head.appendChild(newStyleEl)\n    } else if (styleSheet.href) {\n      // for <link> elements loading CSS from a URL\n      const newLinkEl = source.createElement('link')\n\n      newLinkEl.rel = 'stylesheet'\n      newLinkEl.href = styleSheet.href\n      target.head.appendChild(newLinkEl)\n    }\n  })\n}\n\n/**\n * Convert features props to window features format (name=value,other=value).\n * @param {Object} obj\n * @return {String}\n * @private\n */\n\nfunction toWindowFeatures(obj) {\n  return Object.keys(obj)\n    .reduce((features, name) => {\n      const value = obj[name]\n      if (typeof value === 'boolean') {\n        features.push(`${name}=${value ? 'yes' : 'no'}`)\n      } else {\n        features.push(`${name}=${value}`)\n      }\n      return features\n    }, [])\n    .join(',')\n}\n\n/**\n * Component export.\n * @private\n */\n\nexport default NewWindow\n"],"names":["getOwnPropertySymbols","Object","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","toObject","val","TypeError","shouldUseNative","assign","test1","String","getOwnPropertyNames","test2","i","fromCharCode","map","n","join","test3","split","forEach","letter","keys","err","target","source","from","symbols","to","s","arguments","length","key","call","ReactPropTypesSecret","emptyFunction","shim","props","propName","componentName","location","propFullName","secret","Error","name","getShim","isRequired","ReactPropTypes","array","bool","func","number","object","string","symbol","any","arrayOf","element","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","module","require$$1","NewWindow","container","document","createElement","window","windowCheckerInterval","released","state","this","mounted","ReactDOM","createPortal","children","openChild","setState","url","title","features","onBlock","center","undefined","width","height","left","top","outerWidth","screenX","outerHeight","screenY","screenLeft","screen","screenTop","innerWidth","documentElement","clientWidth","innerHeight","clientHeight","warn","open","toWindowFeatures","setInterval","_this2","closed","release","body","appendChild","copyStyles","addEventListener","close","onUnload","React","PureComponent","styleSheets","rules","styleSheet","cssRules","error","newStyleEl","cssText","cssRule","type","returnText","includes","line","slice","origin","createTextNode","head","href","newLinkEl","rel","obj","reduce","value","push","defaultProps","propTypes"],"mappings":"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"}